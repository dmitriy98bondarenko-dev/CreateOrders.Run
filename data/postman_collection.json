{
  "info": {
    "_postman_id": "8bc79290-45c9-47fd-a198-01efc91fa166",
    "name": "Uklon.CreateSmokeOrders.Run",
    "description": "Для використання колекції необхідно змінити значення змінних колекції, таких як:\n\n- `UserName` - використати свій логін від райдер аккаунта\n- `Password` - використати свій пароль від райдер аккаунта\n- `WalletId` - змінити на гаманець тестового драйвера\n- `AdminLogin` - використати свій логін в адмінку\n- `AdminPassword` - використати свій пароль до адмінки\n    \n\nВ змінну `PromoCode` додано мультикод промо `DRIVER`, який буде дійсний до 01.11.25, після експайру, потрібно перестворити.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "11930149",
    "_collection_link": "https://driver-api-testing.postman.co/workspace/Uklon.DriverWorkspace.Team2~d4a3ef1c-d46a-4494-9732-e2002ffa66df/collection/11930149-8bc79290-45c9-47fd-a198-01efc91fa166?action=share&source=collection_link&creator=11930149"
  },
  "item": [
    {
      "name": "Dependencies",
      "item": [
        {
          "name": "BalanceHelpers",
          "item": [
            {
              "name": "RiderBalanceRecharge",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{adminAuthToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Authorization",
                    "value": "Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMzg0IiwidHlwIjoiSldUIn0.eyJqdGkiOiIwNDUyYjBiNGFhMTI0ODliOTJlODcyNjQ4ZDM3YjMzMSIsInVuaXF1ZV9uYW1lIjoiMzgwOTM1NTEzODM5IiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6IjM4MDkzNTUxMzgzOSIsIm5hbWVpZCI6IjZhZjY1MjUyLWYxNTEtNDlmMC1iZTcwLTQ5NWMyNzFjYWQ1NiIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL25hbWVpZGVudGlmaWVyIjoiNmFmNjUyNTItZjE1MS00OWYwLWJlNzAtNDk1YzI3MWNhZDU2IiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbW9iaWxlcGhvbmUiOiIzODA5MzU1MTM4MzkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9sb2NhbGl0eSI6IjEiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL2dyb3Vwc2lkIjoiUTVWb1BGVnU4OUpERjdUVmhvSDR2MGprdk56elVwbjc2OG1JTTZMNzZUMD0iLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJkLnZvbG9zaHluQHVrbG9uLmNvbS51YSIsImVtYWlsIjoiZC52b2xvc2h5bkB1a2xvbi5jb20udWEiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3JvbGUiOlsiT2JqZWN0T3duZXIiLCJPcmRlckFwaU93bmVyIiwiVHJ1c3RlZFVzZXIiLCJEZXZlbG9wZXIiLCJNYXJrZXRvbG9nIiwiQmV0YVRlc3RlciIsIkFjY291bnRhbnQiLCJJbnN1cmFuY2VBZ2VudCIsIkFjY291bnRhbnRTdXBlcnZpc29yIiwiRGlzcGF0Y2hlciIsIkRpc3BhdGNoU3VwZXJ2aXNvciIsIlF1YWxpdHlBZ2VudCIsIlVrbG9uRW1wbG95ZWUiLCJTbW1NYW5hZ2VyIiwiSW5jaWRlbnRNYW5hZ2VyIiwiVGVtcGxhdGVfTW9kZXJhdG9yIiwiQTJDTWFuYWdlciIsIkdsb2JhbFBhcnRuZXJNb2RlcmF0b3IiLCJBZG1pbmlzdHJhdG9yIiwiUGVhY2VLZWVwZXIiLCJTaHJlayIsIlJlc3RyaWN0ZWRTdXBlcnZpc29yIiwiQjJCTWFuYWdlciIsIlByaWNlTWFuYWdlciIsIkV4dGVybmFsT3BlcmF0b3IiLCJQYXJ0bmVyc01pZ3JhdGlvbk1vZGVyYXRvciIsIkdvZFBhcnRuZXJNb2RlcmF0b3IiLCJHb2RVc2VyIiwiTWFwTW9kZXJhdG9yIiwiR29kQ291cmllck1vZGVyYXRvciIsIkNvdXJpZXJNb2RlcmF0b3IiLCJNb2RlcmF0b3IiLCJQYXJ0bmVyTW9kZXJhdG9yIiwiQWNjZXNzTWFuYWdlciIsIkNvcmVBZG1pbmlzdHJhdG9yIiwiQm9udXNQYXltZW50cyIsIkNvcnBvcmF0ZUNvbXBhbnlBZG1pbmlzdHJhdG9yIiwiUGFydG5lck93bmVyIiwiUGFydG5lclNldHRpbmdNYW5hZ2VyIiwiQjJCRGVsaXZlcnlNYW5hZ2VyIiwiR2xvYmFsQ291cmllck1vZGVyYXRvciIsIkNvdXJpZXJBZG1pbmlzdHJhdG9yIiwiRmluYW5jZUNvbnRyb2xsZXIiLCJ0ZXN0Um9sZUZvckFEIl0sIm5iZiI6MTc0ODU4MDAyMSwiZXhwIjoxNzQ4NTg3MjIxLCJpYXQiOjE3NDg1ODAwMjEsImlzcyI6Imh0dHBzOi8vbm9ucHJvZC51a2xvbi5jb20udWEvIiwiYXVkIjoiaHR0cHM6Ly9ub25wcm9kLnVrbG9uLmNvbS51YS8iLCJwcm9wZXJ0aWVzIjp7ImRldmljZV9pZCI6Ijk1MDE5Mjc1LTAwMTAtNDkxZS05NWMwLWI3ZjUzODQ5OTkzOCIsImFwcF91aWQiOiI5NTAxOTI3NS0wMDEwLTQ5MWUtOTVjMC1iN2Y1Mzg0OTk5MzgiLCJjbGllbnRfaWQiOiJmMjY3OTdmZGM0ZTE0YjlkYmE2NGI1NGEzODFkNDA5NyIsInNvdXJjZSI6IkludGVybmFsIn19.elFetvef6dB7zp4ucWIgXws0EUbfSUO3meh6tCJSc2DAoF5dCQodFg6s4T360jhhJGfP3rDGP1Y4_m9aoHgmVUAs8p6ru-KQKZXSINcg_1l9IAr1MU0VGkUdPetYjN_JfRYeADf_EA20zoEvecUJVOa3zsLLHmFlXRCd6r9n_jwA_UlSwjmw7TZL4Ik-Hc6OJjpNMB71GATBuOI2UXA4tuCM_ODZDmsXOpSOsSurv14wjweK_DEmRL4x__h2bORzHqPP_oB0kNLnNetuzp_XXXvEBOUyJDzyM0hKe6vKZTtSAZO_ML7e-mDqysBmDqE4gC0tsI6C3zVPIC31usOotQ",
                    "disabled": true
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": {\n    \"amount\": 100,\n    \"currency\": \"UAH\"\n  },\n  \"order_id\": \"589f5b9f-4179-4799-9289-c2ef0c43ccc8\",\n  \"description\": \"test\",\n  \"initiated_by_user_id\": \"{{riderId}}\",\n  \"region_id\": {{regionId}},\n  \"profit_loss_type\": \"rider_penalty_other\",\n  \"vb_type\": \"rdr_penalties\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{paymentProcessorHost}}/api/v1/riders/{{riderId}}/wallet-payments/recharge",
                  "host": [
                    "{{paymentProcessorHost}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "riders",
                    "{{riderId}}",
                    "wallet-payments",
                    "recharge"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "DriverBalanceRecharge",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{adminAuthToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"amount\": 1000,\n    \"description\": \"test\",\n    \"initiated_by_user_id\": \"f05a3650-d531-497e-add1-c3badd0c4370\",\n    \"profit_loss_type\": \"driver_app_fee\",\n    \"region_id\": 1,\n    \"vb_type\": \"bonus_order\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{adminGatewayHost}}/api/v2/admin/finance/wallets/{{walletId}}/partner-payments/recharge",
                  "host": [
                    "{{adminGatewayHost}}"
                  ],
                  "path": [
                    "api",
                    "v2",
                    "admin",
                    "finance",
                    "wallets",
                    "{{walletId}}",
                    "partner-payments",
                    "recharge"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "DriverBalanceCharge",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "noauth"
                },
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"amount\": 2000,\n    \"description\": \"Test\",\n    \"initiated_by_user_id\": \"f05a3650d531497eadd1c3badd0c4370\",\n    \"profit_loss_type\": \"driver_penalty_order_other\",\n    \"region_id\": 1,\n    \"vb_type\": \"cash_order_fee\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{adminGatewayHost}}/api/v2/admin/finance/wallets/{{walletId}}/partner-payments/charge",
                  "host": [
                    "{{adminGatewayHost}}"
                  ],
                  "path": [
                    "api",
                    "v2",
                    "admin",
                    "finance",
                    "wallets",
                    "{{walletId}}",
                    "partner-payments",
                    "charge"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "RiderBalanceCharge",
              "event": [
                {
                  "listen": "prerequest",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                },
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      ""
                    ],
                    "type": "text/javascript",
                    "packages": {}
                  }
                }
              ],
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{adminAuthToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "POST",
                "header": [
                  {
                    "key": "accept",
                    "value": "*/*"
                  },
                  {
                    "key": "Authorization",
                    "value": "{{adminAuthToken}}",
                    "disabled": true
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"amount\": {\n    \"amount\": 10,\n    \"currency\": \"UAH\"\n  },\n  \"order_id\": \"589f5b9f-4179-4799-9289-c2ef0c43ccc8\",\n  \"description\": \"test\",\n  \"initiated_by_user_id\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n  \"region_id\": 1,\n  \"profit_loss_type\": \"rider_penalty_other\",\n  \"vb_type\": \"rdr_penalties\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                },
                "url": {
                  "raw": "{{paymentProcessorHost}}/api/v1/riders/{{riderId}}/wallet-payments/charge",
                  "host": [
                    "{{paymentProcessorHost}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "riders",
                    "{{riderId}}",
                    "wallet-payments",
                    "charge"
                  ]
                }
              },
              "response": []
            },
            {
              "name": "GetRiderPaymentMethod",
              "request": {
                "auth": {
                  "type": "bearer",
                  "bearer": [
                    {
                      "key": "token",
                      "value": "{{riderAuthToken}}",
                      "type": "string"
                    }
                  ]
                },
                "method": "GET",
                "header": [
                  {
                    "key": "accept",
                    "value": "application/json"
                  },
                  {
                    "key": "client_id",
                    "value": "{{clientId}}"
                  },
                  {
                    "key": "locale",
                    "value": "ru"
                  },
                  {
                    "key": "city",
                    "value": "Kyiv"
                  },
                  {
                    "key": "app_uid",
                    "value": "{{appUid}}"
                  },
                  {
                    "key": "Authorization",
                    "value": "Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMzg0IiwidHlwIjoiSldUIn0.eyJqdGkiOiI5NjUxMGQ4MTY2ZTg0ZTRkOGJlM2RjM2E1NGNkZWZiMCIsInVuaXF1ZV9uYW1lIjoiMzgwOTM1NTEzODMzIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6IjM4MDkzNTUxMzgzMyIsIm5hbWVpZCI6ImJjNGMyZjUxLWRjOGYtNDc5Yy05MzE3LTUzOTAwZjdlZTZjNyIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL25hbWVpZGVudGlmaWVyIjoiYmM0YzJmNTEtZGM4Zi00NzljLTkzMTctNTM5MDBmN2VlNmM3IiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbW9iaWxlcGhvbmUiOiIzODA5MzU1MTM4MzMiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9sb2NhbGl0eSI6IjEiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL2dyb3Vwc2lkIjoiSjFBVkY0Z3VhR0hwTTZZam5JWWo2UmRBMjNOakZCaHBUWkdMdHprNmFnST0iLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9lbWFpbGFkZHJlc3MiOiJkQHVrci5uZXQiLCJlbWFpbCI6ImRAdWtyLm5ldCIsIm5iZiI6MTc0NTQ5ODE0NCwiZXhwIjoxNzQ1NTAxNzQ0LCJpYXQiOjE3NDU0OTgxNDQsImlzcyI6Imh0dHBzOi8vc3RhZ2luZy51a2xvbi5jb20udWEvIiwiYXVkIjoiaHR0cHM6Ly9zdGFnaW5nLnVrbG9uLmNvbS51YS8iLCJwcm9wZXJ0aWVzIjp7ImRldmljZV9pZCI6IjhhNTFlZjQwLTI3ZDQtNDRmNy1iZWU3LTQ2ZTFlNGZiNmY1MSIsImFwcF91aWQiOiI4YTUxZWY0MC0yN2Q0LTQ0ZjctYmVlNy00NmUxZTRmYjZmNTEiLCJjbGllbnRfaWQiOiI2Mjg5ZGU4NTFmYzcyNmY4ODdhZjhkNWQ3YTU2YzYzNSIsInNvdXJjZSI6IklkZW50aXR5MiJ9fQ.UhU9rbMzumRGXIviVqj0VoHmE8jyVixA0tp8BoRlL4tiu58kNDpxAm3S1m3SdbzfHAMXU8iJcslGXgt-IvHZfHZ-l9QiOxUIfubUE8LBMZqm2CBHsQalJZ_1STuoLUD1bNIT3y27butUNd4SBQjL0vTF099TLBrwWCciSJHXseW4MQdkWdxxvVAl_4-RLzrKWwZlFlAbO6EdxCEAyazpVEILryxeT-Qll9-DddAyXEeJWHqIMjotaVtsLrHUdQ1jIeigYiIlKhjk6lb6ihe_U7IzoOceUGCVzaunyYNpvTEMKRyCO3CS11wmeao9lTWxKP_ZrUzMq-CR8QO481iwSQ",
                    "disabled": true
                  }
                ],
                "url": {
                  "raw": "{{riderGatewayHost}}/api/v1/payment-methods",
                  "host": [
                    "{{riderGatewayHost}}"
                  ],
                  "path": [
                    "api",
                    "v1",
                    "payment-methods"
                  ]
                }
              },
              "response": []
            }
          ]
        },
        {
          "name": "Cancel Order by rider",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{riderAuthToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [
              {
                "key": "app_uid",
                "value": "{{appUid}}",
                "type": "text"
              },
              {
                "key": "client_id",
                "value": "{{clientId}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"plans_changed\",\n  \"comment\": \"\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{riderGatewayHost}}/api/v1/orders/{{orderId}}",
              "host": [
                "{{riderGatewayHost}}"
              ],
              "path": [
                "api",
                "v1",
                "orders",
                "{{orderId}}"
              ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "if (pm.collectionVariables.get(\"needAuth\") == \"true\"){",
          "    eval(pm.globals.get(\"fetchAuthTokensFn\"));",
          "",
          "    fetchAuthTokens({",
          "        host: \"internalIdentityHost\",",
          "        username: \"adminUsername\",",
          "        password: \"adminPassword\",",
          "        tokenName: \"adminAuthToken\"",
          "    });",
          "",
          "    fetchAuthTokens({",
          "        host: \"identityHost\",",
          "        username: \"riderUserName\",",
          "        password: \"riderPassword\",",
          "        tokenName: \"riderAuthToken\"",
          "    });",
          "",
          "    fetchAuthTokens({",
          "        host: \"partnersIdentityHost\",",
          "        username: \"driverPhone\",",
          "        password: \"driverPassword\",",
          "        tokenName: \"driverAuthToken\"",
          "    });",
          "",
          "    pm.collectionVariables.set(\"needAuth\", \"false\")",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "if (pm.response.code === 401){",
          "    pm.collectionVariables.set(\"needAuth\", \"true\")",
          "    console.log(\"needAuth set to true\")",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "needAuth",
      "value": "true"
    },
    {
      "key": "orderId",
      "value": ""
    },
    {
      "key": "randomGuid",
      "value": ""
    },
    {
      "key": "changeRequestFareId",
      "value": ""
    },
    {
      "key": "currentFareId",
      "value": ""
    },
    {
      "key": "driverAuthToken",
      "value": ""
    },
    {
      "key": "corporateRiderAuthToken",
      "value": ""
    },
    {
      "key": "adminAuthToken",
      "value": ""
    },
    {
      "key": "riderAuthToken",
      "value": ""
    },
    {
      "key": "regionId",
      "value": "",
      "type": "default"
    },
    {
      "key": "paymentMethodId",
      "value": "",
      "type": "string"
    },
    {
      "key": "cashPaymentMethodId",
      "value": "",
      "type": "string"
    },
    {
      "key": "lastUsedPaymentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "fareEstimatePayloadBase",
      "value": "",
      "type": "string"
    },
    {
      "key": "savePaymentMethodsFn",
      "value": "",
      "type": "string"
    }
  ]
}